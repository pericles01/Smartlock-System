#: import GlobalComponents views.GlobalComponents
#: import UserHomeView views.UserHomeView
#:import FadeTransition kivy.uix.screenmanager.FadeTransition

<UpdateUserPinView>:
    MDFloatLayout:
        size_hint: .8, .9
        pos_hint: {"center_x": .5, "center_y": .5}
        MDCard:
            size_hint_x: .7
            spacing: dp(10)
            pos_hint: {"center_x": .5, "center_y": .5}
            orientation: "vertical"
            elevation: 4
            shadow_offset: (0, 1)
            md_bg_color : CardBackgroundColor

            MDLabel:
                text : 'Update PIN'
                font_style : 'H5'
                halign : "center"
                size_hint_x: .7
                pos_hint: {"center_x": .5, "center_y": .5}

            MDSeparator:

            MDRelativeLayout:
                size_hint_x: .6
                pos_hint: {"center_x": .5, "center_y": .5}
                MDGridLayout:
                    rows: 2
                    spacing: dp(10)
                    MDLabel:
                        text : 'Set new PIN'
                        font_style : 'H6'
                        halign : "center"
                        size_hint_x: .7
                        pos_hint: {"center_x": .5, "center_y": .5}

                    ClickableTextFieldRound:
                        id: new_pin
                        pos_hint: {"center_x": .5, "center_y": .5}

            MDSeparator:

            MDRelativeLayout:
                size_hint_x: .6
                pos_hint: {"center_x": .5, "center_y": .5}
                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(10)
                    MDLabel:
                        text : 'Confirm new PIN'
                        font_style : 'H6'
                        halign : "center"
                        size_hint_x: .7
                        pos_hint: {"center_x": .5, "center_y": .5}

                    ClickableTextFieldRound:
                        id: confirm_pin
                        pos_hint: {"center_x": .5, "center_y": .5}

            MDSeparator:

            MDRelativeLayout:
                size_hint_x: .6
                pos_hint: {"center_x": .5, "center_y": .5}
                MDBoxLayout:
                    orientation: "vertical"
                    spacing: dp(10)

                    MDFillRoundFlatIconButton:
                        id: update_button
                        text: "Update"
                        icon: "content-save-check"
                        pos_hint: {"center_x": .5, "center_y": .5}
                        on_press: root.update_pin()

                    MDLabel:
                        id: error_label
                        text : '* required fields, PIN must have 6 digits'
                        font_style : 'Subtitle2'
                        theme_text_color: "Error"
                        halign : "center"
                        size_hint_x: .8
                        pos_hint: {"center_x": .5, "center_y": .5}

<UserMembershipView>:
    MDBoxLayout:
        orientation: "vertical"
        padding: 0, 0, 0, dp(10)

        MDTopAppBar:
            id: topbar
            pos_hint: {"top": 1}
            anchor_title: "center"
            type_height: "small"
            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
            right_action_items: [["home", lambda x: app.manager.push("welcome"), "home"]]

        MDNavigationLayout:
            MDScreenManager:
                id: manager
                transition:
                    FadeTransition(duration=.2, clearcolor=app.theme_cls.bg_dark)

                UpdateUserPinView:
                    name: "pin"
                    id: update_pin_screen

                UserHomeView:
                    name: "home"
                    id: user_welcome_screen

            MDNavigationDrawer:
                id: nav_drawer
                radius: (0, 16, 16, 0)

                MDNavigationDrawerMenu:
                    spacing: dp(10)
                    DrawerClickableItem:
                        icon: "home"
                        text_right_color: "#4a4939" # white
                        text: "Home"
                        on_press:
                            manager.current="home"
                            nav_drawer.set_state("close")

                    MDNavigationDrawerDivider:

                    DrawerClickableItem:
                        icon: "numeric"
                        text: "Change PIN"
                        on_press:
                            manager.current="pin"
                            nav_drawer.set_state("close")

                    MDNavigationDrawerDivider:

                    DrawerClickableItem:
                        icon: "qrcode-scan"
                        text: "Generate QR-Code"
                        on_press:
                        #    manager.current="pin"
                            nav_drawer.set_state("close")

                    MDNavigationDrawerDivider:

                    DrawerClickableItem:
                        icon: "face-recognition"
                        text: "Update Face recognition"
                        on_press:
                        #    manager.current="pin"
                            nav_drawer.set_state("close")

                    MDNavigationDrawerDivider: