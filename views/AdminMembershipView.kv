#: import GlobalComponents views.GlobalComponents
#:import FadeTransition kivy.uix.screenmanager.FadeTransition

<UrgencyDoorOpen>:
    MDCard:
        pos_hint : {"center_x":.5,"center_y":.5}
        md_bg_color : CardBackgroundColor
        padding : dp(15)
        spacing : dp(20)
        orientation : "vertical"

        MDLabel:
            id: user_info_label
            font_style : 'H6'
            halign : "center"
            size_hint_y: None
            height: self.texture_size[1]
            pos_hint: {"center_x": .5, "center_y": .5}

        MDSeparator:

        MDLabel:
            text : "Please Scan the urgency card to open the user's door"
            font_style : 'H6'
            halign : "center"
            pos_hint: {"center_x": .5, "center_y": .5}
            theme_text_color: "Error"

        MDIconButton:
            icon: "account-card"
            icon_size: "60sp"
            pos_hint: {"center_x": .5, "center_y": .5}
            theme_icon_color: "Error" #app.theme_cls.primary_color


<UpdateCredentialView>:
    MDCard:
        size_hint: .6, .9
        pos_hint : {"center_x":.5,"center_y":.5}
        md_bg_color : CardBackgroundColor
        padding : dp(15)
        spacing : dp(20)
        orientation : "vertical"

        MDLabel:
            text : 'Update login credentials'
            font_style : 'H5'
            halign : "center"
            size_hint_x: .8 #, .5
            pos_hint: {"center_x": .5, "center_y": .5}

        MDSeparator:

        MDRelativeLayout:
            size_hint_x: .6
            pos_hint: {"center_x": .5, "center_y": .5}
            MDGridLayout:
                rows: 2
                spacing: dp(15)

                MDLabel:
                    text : 'Enter new username'
                    font_style : 'H6'
                    halign : "center"
                    size_hint: .5, .5
                    pos_hint: {"center_x": .5, "center_y": .5}

                MDTextField :
                    id: new_username_field
                    hint_text : "Username *"
                    multiline: False
                    mode: "round"
                    icon_left : "account"
                    size_hint_x : .6
                    font_size : 20
                    pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDRelativeLayout:
            size_hint_x: .8
            pos_hint: {"center_x": .5, "center_y": .5}
            MDBoxLayout:
                orientation: "vertical"
                spacing: dp(15)

                MDLabel:
                    text : 'Enter new password'
                    font_style : 'H6'
                    halign : "center"
                    size_hint: .7, .5
                    pos_hint: {"center_x": .5, "center_y": .5}

                MDRelativeLayout:
                    pos_hint : {"center_x":.5,"center_y":.5}
                    size_hint_x: .6
                    ClickableTextFieldRound:
                        id: new_password_widget
                        pos_hint: {"center_x": .5, "center_y": .5}

        MDSeparator:

        MDRelativeLayout:
            size_hint_x: .8
            pos_hint: {"center_x": .5, "center_y": .5}
            MDBoxLayout:
                orientation: "vertical"
                spacing: dp(15)

                MDLabel:
                    text : 'Confirm new password'
                    font_style : 'H6'
                    halign : "center"
                    size_hint: .7, .5
                    pos_hint: {"center_x": .5, "center_y": .5}

                MDRelativeLayout:
                    pos_hint : {"center_x":.5,"center_y":.5}
                    size_hint_x: .6
                    ClickableTextFieldRound:
                        id: new_password_widget_confirmation
                        pos_hint: {"center_x": .5, "center_y": .5}

        MDSeparator:

        MDBoxLayout:
            orientation: "vertical"
            spacing: dp(10)

            MDFillRoundFlatIconButton:
                id: update_button
                text: "Update & save"
                icon: "content-save-check"
                font_size : 15
                pos_hint: {"center_x": .5, "center_y": .5}
                on_release: root.update_credentials()

            MDLabel:
                id: error_label
                text : '* required fields'
                font_style : 'Subtitle2'
                theme_text_color: "Error"
                halign : "center"
                size_hint_x: .9
                pos_hint: {"center_x": .5, "center_y": .5}



<SwipeToEditItem>:
    size_hint_y: None
    height: content.height
    #swipe_distance: 50
    max_opened_x: dp(150)
    type_swipe: "hand"

    MDCardSwipeLayerBox:
        padding: dp(8)
        radius: [16, 16, 16, 16]

        MDIconButton:
            icon: "trash-can"
            pos_hint: {"center_y": .5}
            on_release: root.remove_item_confirmation(root)

        MDIconButton:
            icon: "eye-settings"
            pos_hint: {"center_y": .5}
            on_release: root.edit_item(root)

        MDIconButton:
            icon: "alarm-light"
            pos_hint: {"center_y": .5}
            on_release: root.urgency_open(root)

    MDCardSwipeFrontBox:

        TwoLineListItem:
            id: content
            text: root.text
            secondary_text: root.description
            _no_ripple_effect: True
            bg_color: CardBackgroundColor
            radius: [16, 16, 16, 16]


<AddUserForm>:
    MDCard:
        pos_hint : {"center_x":.5,"center_y":.5}
        md_bg_color : CardBackgroundColor
        padding : dp(15)
        spacing : dp(10)
        orientation : "vertical"
        MDLabel:
            text : 'Enter User Name'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5}
        MDGridLayout:
            pos_hint: {"center_x": .5, "center_y": .5}
            cols: 2
            spacing: dp(15)
            MDRelativeLayout:
                MDTextField :
                    id: firstname_field
                    hint_text : "firstname *"
                    multiline: False
                    mode: "round"
                    icon_left : "account"
                    size_hint_x : .9
                    font_size : 20
                    pos_hint : {"center_x":.5, "center_y": .5}
            MDRelativeLayout:
                MDTextField :
                    id: lastname_field
                    hint_text : "lastname *"
                    multiline: False
                    mode: "round"
                    icon_left : "account"
                    size_hint_x : .9
                    font_size : 20
                    pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDLabel:
            text : 'Enter RFID Code'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5, "center_y": .5}

        MDTextField :
            id: rfid_field
            hint_text : "RFID Code *"
            multiline: False
            mode: "round"
            icon_left : "numeric"
            size_hint_x : .6
            font_size : 20
            pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDLabel:
            text : 'Enter Door Number'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5, "center_y": .5}

        MDTextField :
            id: door_number_field
            hint_text : "Door number *"
            multiline: False
            mode: "round"
            icon_left : "numeric"
            size_hint_x : .6
            font_size : 20
            pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDLabel:
            text : 'Enter User Description'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5}

        MDTextField :
            id: description_field
            hint_text : "User Description"
            icon_left : "account"
            multiline: False
            mode: "round"
            size_hint_x : .8
            font_size : 20
            pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDGridLayout:
            pos_hint: {"center_x": .5, "center_y": .5}
            cols: 2
            spacing: dp(15)

            MDRelativeLayout:
                MDFillRoundFlatIconButton:
                    id: save_button
                    text: "Save"
                    icon: "content-save"
                    pos_hint: {"center_x": .5, "center_y": .5}

            MDRelativeLayout:
                MDFillRoundFlatIconButton:
                    id: exit_button
                    text: "Exit"
                    icon: "exit-to-app"
                    pos_hint: {"center_x": .5, "center_y": .5}

        MDLabel:
            id: error_label
            text: "* required fields"
            halign: "center"
            size_hint_y : None
            height : dp(20)
            theme_text_color: "Error"
            font_style: "Subtitle2"
            pos_hint: {"center_x": .5, "center_y": .5}

<UserInfoForm>
    MDCard:
        pos_hint : {"center_x":.5,"center_y":.5}
        md_bg_color : CardBackgroundColor
        padding : dp(20)
        spacing : dp(10)
        orientation : "vertical"
        MDLabel:
            text : 'User Name'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5}
            size: self.texture_size
        MDGridLayout:
            pos_hint: {"center_x": .5, "center_y": .5}
            cols: 2
            spacing: dp(15)
            MDRelativeLayout:
                MDTextField :
                    id: firstname_field
                    hint_text : "firstname *"
                    multiline: False
                    mode: "round"
                    icon_left : "account"
                    size_hint_x : .9
                    font_size : 20
                    pos_hint : {"center_x":.5, "center_y": .5}
            MDRelativeLayout:
                MDTextField :
                    id: lastname_field
                    hint_text : "lastname *"
                    multiline: False
                    mode: "round"
                    icon_left : "account"
                    size_hint_x : .9
                    font_size : 20
                    pos_hint : {"center_x":.5, "center_y": .5}
        MDSeparator:

        MDLabel:
            text : 'RFID Code'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5, "center_y": .5}

        MDTextField :
            id: rfid_field
            hint_text : "RFID Code *"
            multiline: False
            mode: "round"
            icon_left : "numeric"
            size_hint_x : .6
            font_size : 20
            pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDLabel:
            text : 'Door number'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5, "center_y": .5}

        MDTextField :
            id: door_number_field
            hint_text : "Door number *"
            multiline: False
            mode: "round"
            icon_left : "numeric"
            size_hint_x : .6
            font_size : 20
            pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDLabel:
            text : 'User Description'
            font_style : 'H6'
            halign : "center"
            size_hint: .5, .5
            pos_hint: {"center_x": .5, "center_y": .5}

        MDTextField :
            id: description_field
            hint_text : "User Description"
            icon_left : "account"
            multiline: False
            mode: "round"
            size_hint_x : .8
            font_size : 20
            pos_hint : {"center_x":.5, "center_y": .5}

        MDSeparator:

        MDGridLayout:
            pos_hint: {"center_x": .5, "center_y": .5}
            cols: 2
            spacing: dp(15)

            MDRelativeLayout:
                MDFillRoundFlatIconButton:
                    id: save_button
                    text: "Edit & Save"
                    icon: "content-save"
                    pos_hint: {"center_x": .5, "center_y": .5}
                    md_bg_color_disabled: CardBackgroundColor

            MDRelativeLayout:
                MDFillRoundFlatIconButton:
                    id: exit_button
                    text: "Exit"
                    icon: "exit-to-app"
                    pos_hint: {"center_x": .5, "center_y": .5}

        MDLabel:
            id: error_label
            text: ""
            halign: "center"
            size_hint_y : None
            height : dp(20)
            theme_text_color: "Error"
            font_style: "Subtitle2"
            pos_hint: {"center_x": .5, "center_y": .5}

<AdminMembershipView>:
    MDBoxLayout:
        orientation: "vertical"
        padding: 0, 0, 0, dp(10)

        MDTopAppBar:
            pos_hint: {"top": 1}
            title: "Hello Admin!"
            anchor_title: "center"
            type_height: "small"
            left_action_items: [["menu", lambda x: nav_drawer.set_state("open")]]
            right_action_items: [["home", lambda x: app.manager.push("welcome"), "home"]]

        MDNavigationLayout:
            MDScreenManager:
                id: manager
                transition:
                    FadeTransition(duration=.2, clearcolor=app.theme_cls.bg_dark)

                MDScreen:
                    name: "manage"
                    MDBoxLayout:
                        orientation: "vertical"
                        padding: 0, 0, 0, dp(10)

                        MDRelativeLayout:
                            size_hint: .8, .4
                            pos_hint: {"center_x": .5, "center_y": .5}
                            spacing: dp(5)
                            MDCard:
                                size_hint : .7, .9
                                pos_hint : {"center_x":.5,"center_y":.5}
                                elevation : 3
                                md_bg_color : CardBackgroundColor
                                spacing : dp(5)
                                orientation : "vertical"
                                shadow_offset: (0, 1)
                                MDLabel:
                                    text : 'Add User'
                                    font_style : 'H6'
                                    halign : "center"
                                    size_hint: .5, .5
                                    pos_hint: {"center_x": .5, "center_y": .5}

                                MDSeparator:
                                    color: "FFFFFF" # white
                                MDGridLayout:
                                    pos_hint: {"center_x": .5, "center_y": .5}
                                    cols: 2
                                    MDRelativeLayout:
                                        padding: dp(20)
                                        MDFillRoundFlatIconButton:
                                            text: "Load Users file"
                                            icon: "folder"
                                            pos_hint: {"center_x": .5, "center_y": .5}
                                            on_release: root.file_manager_open()

                                    MDRelativeLayout:
                                        padding: dp(20)
                                        MDFillRoundFlatIconButton:
                                            text: "fill the form"
                                            icon: "form-select"
                                            pos_hint: {"center_x": .5, "center_y": .5}
                                            on_release: root.show_userform_dialog()

                        MDGridLayout:
                            rows: 2
                            #spacing: dp(5)
                            size_hint_y: .2
                            MDLabel:
                                text : 'Users data preview'
                                font_style : 'H6'
                                halign : "center"
                                size_hint: .5, None
                                height: dp(25)
                                pos_hint: {"center_x": .5, "center_y": .5}
                            MDLabel:
                                text : 'Firstname | Lastname | RFID | Door number'
                                font_style : 'Subtitle1'
                                halign : "center"
                                size_hint: .5, None
                                height: dp(25)
                                pos_hint: {"center_x": .5, "center_y": .5}

                        MDRelativeLayout:
                            size_hint_x: .5 #, .9
                            pos_hint: {"center_x": .5, "center_y": .5}
                            MDRecycleView:
                                id: rv
                                viewclass: 'SwipeToEditItem'
                                RecycleBoxLayout:
                                    default_size: None, dp(70)
                                    default_size_hint: 1, None
                                    size_hint_y: None
                                    height: self.minimum_height #+ dp(20)
                                    orientation: 'vertical'
                                    spacing: dp(10)
                                    padding: dp(10)

                UpdateCredentialView:
                    name: "update_credentials"
                    id: update_credentials_view


            MDNavigationDrawer:
                id: nav_drawer
                radius: (0, 16, 16, 0)

                MDNavigationDrawerMenu:
                    spacing: dp(10)
                    DrawerClickableItem:
                        icon: "library"
                        text_right_color: "#4a4939" # white
                        text: "Manage"
                        on_press:
                            manager.current="manage"
                            nav_drawer.set_state("close")

                    MDNavigationDrawerDivider:

                    DrawerClickableItem:
                        icon: "login"
                        text: "Update Login Credentials"
                        on_press:
                            manager.current="update_credentials"
                            nav_drawer.set_state("close")

                    MDNavigationDrawerDivider: